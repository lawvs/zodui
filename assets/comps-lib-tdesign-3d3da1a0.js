var Ne=Object.defineProperty;var $e=(n,t,e)=>t in n?Ne(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var U=(n,t,e)=>($e(n,typeof t!="symbol"?t+"":t,e),e),De=(n,t,e)=>{if(!t.has(n))throw TypeError("Cannot "+e)};var B=(n,t,e)=>(De(n,t,"read from private field"),e?e.call(n):t.get(n)),de=(n,t,e)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,e)};import{j as ae,r as u}from"./react-64d51446.js";import*as j from"zod";import{ZodFirstPartyTypeKind as pe,ZodError as ye}from"zod";import{B as je,I as Ee,a as Me,b as xe,S as Ae,c as Pe,R as fe,D as Ve,d as Le,T as Ue,e as Fe,f as Ke,g as ze,h as Be,i as He,j as qe,k as Ge}from"./tdesign-react-90877bd8.js";import{A as We,M as Je,L as Qe,C as Xe,D as Ye,R as me,a as et,b as tt}from"./tdesign-icons-react-1b74273e.js";const O=ae.Fragment,c=ae.jsx,k=ae.jsxs,nt="modulepreload",rt=function(n){return"/zodui/"+n},he={},re=function(t,e,r){if(!e||e.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(e.map(o=>{if(o=rt(o),o in he)return;he[o]=!0;const i=o.endsWith(".css"),a=i?'[rel="stylesheet"]':"";if(!!r)for(let v=s.length-1;v>=0;v--){const g=s[v];if(g.href===o&&(!i||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const f=document.createElement("link");if(f.rel=i?"stylesheet":nt,i||(f.as="script",f.crossOrigin=""),f.href=o,document.head.appendChild(f),i)return new Promise((v,g)=>{f.addEventListener("load",v),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};var st=(n=>{})();const d={...st,...pe},ot=[],it=[d.ZodTuple,d.ZodObject],ct=[d.ZodRecord,d.ZodMap],at=[d.ZodString,d.ZodNumber,d.ZodBoolean,d.ZodDate],ut=at,lt=[d.ZodUnion,d.ZodDiscriminatedUnion],dt=lt,ft=[d.ZodArray,d.ZodTuple,d.ZodSet,d.ZodMap,d.ZodRecord,d.ZodObject],ge=ft;function be(n,t){const e=t??n,r=t?`framework.${t.key}.units`:"units";let s=function(o,i,a){return i.map(f=>`${r}.${o}.${f}`).forEach(f=>{n.upd(f,(v=[])=>v.concat(a),v=>v.filter(g=>!a.includes(g)))}),this};return s=s.bind(e),s.composer=function(o,i){return this},s.composer=s.composer.bind(e),s.switcher=function(o,i){return this},s.switcher=s.switcher.bind(e),s}class mt{constructor(t,e){U(this,"defineUnit");U(this,"defineRndr",this.defineRender);this.key=t,this.ctx=e,this.defineUnit=be(e,this)}defineComp(t,e){return this.ctx.set(`framework.${this.key}.components.${t}`,e),this}defineIcon(t,e){return this.ctx.set(`framework.${this.key}.icons.${t}`,e),this}defineRender(t,e){return this.ctx.set(`framework.${this.key}.rndrs.${t}`,e),this}}function ne(n,t){return{name:n,call:t}}const F=Symbol("effect");var P;class ht{constructor(){de(this,P,new Map)}on(t,e){const r=B(this,P).get(t)||[],s=r.length;return r.push(e),B(this,P).set(t,r),()=>{r.splice(s,1),B(this,P).set(t,r)}}do(...t){const[e,...r]=t;(B(this,P).get(e)||[]).forEach(o=>o(...r))}}P=new WeakMap;var Gt;const G=class G{constructor(t=new Map,e=new ht){U(this,Gt,[]);U(this,"defineUnit");this.store=t,this.emitter=e,this.defineUnit=be(this)}extend(){return new G(this.store,this.emitter)}set(t,e){var r;return(r=this.store)==null||r.set(t,e),this.emitter.do(t,e),this[F].push(()=>{var o,i;((o=this.store)==null?void 0:o.get(t))===e&&((i=this.store)==null||i.delete(t))}),this}upd(t,e,r){var o,i;const s=e((o=this.store)==null?void 0:o.get(t));return(i=this.store)==null||i.set(t,s),this.emitter.do(t,s),this[F].push(()=>{var a,l;(l=this.store)==null||l.set(t,r((a=this.store)==null?void 0:a.get(t)))}),this}del(t){var r,s;const e=(r=this.store)==null?void 0:r.get(t);return(s=this.store)==null||s.delete(t),this.emitter.do(t),this[F].push(()=>{var o;(o=this.store)==null||o.set(t,e)}),this}get(t){var e;return[(e=this.store)==null?void 0:e.get(t),this.emitter.on.bind(this.emitter,t)]}use(t){let e;const r=this.extend();function s(i){i.call(r),e=()=>{r[F].forEach(a=>a())}}if(typeof t=="function"){const i=t();if(i instanceof Promise){let a=!1;i.then(l=>{a||(l.default&&(l=l.default),s(l))}),e=()=>{a=!0}}else throw new Error("plugin must be a function or a promise")}else s(t);const o=()=>e();return this[F].push(o),o}framework(t){return new mt(t,this)}};Gt=F,U(G,"global",new G);let oe=G;function ve(n){var t;return((t=n==null?void 0:n.split(" "))==null?void 0:t.filter(e=>e!==" "&&e!==""))??[]}const b=(n,t)=>{var e;return((e=(n==null?void 0:n._def)||n)==null?void 0:e.typeName)===t};function ee(n,t){var e;return t.includes((e=n==null?void 0:n._def)==null?void 0:e.typeName)}function q(n){var t;if(b(n,pe.ZodDefault))return(t=n==null?void 0:n._def)==null?void 0:t.defaultValue()}function Ce(n){return n.replace(/\[([^\]]+)]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>').replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>").replace(/~~([^~]+)~~/g,"<del>$1</del>").replace(/\n/g,"<br />").replace(/\|\|([^|]+)\|\|/g,'<span class="spoiler">$1</span>')}function ie(n,t){const e=Object.keys(n),r=Object.keys(t);for(const s of e){const o=n[s];if(Object.hasOwn(t,s)){const i=t[s];if(Array.isArray(o)&&Array.isArray(i)){[...o,...i];break}if(typeof o=="object"&&typeof i=="object"){ie(o,i);break}}n[s]}for(const s of r)Object.hasOwn(n,s)||t[s];return{...n,...t}}function V(...n){return n.filter(t=>!!t).map(t=>typeof t=="string"?t:Object.keys(t).filter(e=>t[e]).join(" ")).join(" ")}function _e(n){try{!Object.hasOwn(j.ZodType.prototype,`_${n}`)&&Object.defineProperty(j.ZodType.prototype,`_${n}`,{get(){return this._def[n]}}),!Object.hasOwn(j.ZodType.prototype,n)&&Object.defineProperty(j.ZodType.prototype,n,{get(){return t=>{const e=this.constructor;return new e({...this._def,[n]:t})}}})}catch(t){console.error(t)}}_e("mode");_e("label");!Object.hasOwn(j.ZodType.prototype,"type")&&Object.defineProperty(j.ZodType.prototype,"type",{get(){var n;return((n=this._def)==null?void 0:n.typeName.replace("Zod","").toLowerCase())??"unknown"}});const we={...j};function pt(n){return j.object(new n)}we.clazz=pt;function yt(n){return j.object(n)}we.asObject=yt;const Te=u.createContext(null);function gt(){const[n,t]=u.useState("");return{className:n,ControllerClassName:u.useCallback(({children:e})=>c(Te.Provider,{value:{setClassName:t},children:e}),[])}}const en=()=>u.useContext(Te),bt=u.createContext(null),W=n=>{const t=u.useContext(bt)??oe.global,[e,r]=t.get(n),[s,o]=u.useState(()=>e);return u.useEffect(()=>{o(()=>e)},[e]),u.useEffect(()=>r(i=>o(()=>i)),[r]),s},L=n=>W(`framework.react.components.${n}`),vt=n=>W(`framework.react.icons.${n}`),Ie=u.createContext(null);function Ct({error:n,setE:t}){return u.useEffect(()=>{t(n)},[n,t]),c(O,{})}function _t(){const[n,t]=u.useState(),e=u.useMemo(()=>({reset:()=>t(void 0),error:n,throwError(r){return typeof r=="string"&&(r=new Error(r)),r.message===(n==null?void 0:n.message)?null:c(Ct,{error:r,setE:t})},ThrowError({error:r}){return this.throwError(r)}}),[n]);return{reset:()=>t(void 0),error:n,ErrorHandler:u.useCallback(({children:r})=>c(Ie.Provider,{value:e,children:r}),[e])}}const Re=()=>u.useContext(Ie),ce=u.createContext(null);function tn(n={}){const t=u.useContext(ce),[e,r]=u.useState(n),s=u.useMemo(()=>({...Ze,...t,...e}),[t,e]);return{configure:s,setConfigure:r,ItemConfigurer:({children:o})=>c(ce.Provider,{value:s,children:o})}}const Ze={verifyDebounceTime:300,actualTimeVerify:!0},Se=()=>u.useContext(ce)??Ze,ke=u.createContext(null);function wt(){const n=u.useRef(),t=u.useCallback(s=>(n.current=s,()=>{n.current=void 0}),[]),e=u.useRef(),r=u.useCallback(s=>{var o;e.current=s,(o=n.current)==null||o.call(n,s)},[]);return{Append:()=>{const[s,o]=u.useState(e.current);return u.useEffect(()=>t(o),[]),c(O,{children:s})},ItemSerter:u.useCallback(({children:s})=>c(ke.Provider,{value:{Append:({children:o,deps:i=[]})=>(u.useEffect(()=>r(o),[...i]),null)},children:s}),[r])}}const Tt=()=>u.useContext(ke),Oe=n=>{const t=vt(n.name);return t?c(t,{...n}):c(O,{})},E=({icon:n,...t})=>{t=Object.assign({shape:"square",variant:"outline"},t);const e=u.useMemo(()=>typeof n=="string"?c(Oe,{name:n}):n,[n]),r=L("Button");return r?c(r,{icon:e,...t}):c("button",{...t,children:t.children?t.children:e})},It=n=>{const t=L("Dropdown");return t?c(t,{...n}):c(O,{})},Y=n=>{const t=L("Input");if(t)return c(t,{...n});const{onChange:e,value:r,defaultValue:s,...o}=n;return c("input",{value:r??s??"",onChange:i=>{const a=i.target.value;if(n.type==="number"){e==null||e(Number(a));return}e==null||e(a)},...o})},nn=n=>{const t=L("InputAdornment");if(t)return c(t,{...n});const{prev:e,next:r,children:s,className:o,style:i}=n;return k("span",{className:"zodui-input-adornment"+(o?" "+o:""),style:i,children:[e,s,r]})},rn=n=>{const t=L("RadioGroup");return t?c(t,{...n}):c(O,{children:"Not support Radio Group"})},Rt=n=>{const t=L("Select");if(t)return c(t,{...n});n=Object.assign({},n);const{onChange:e,...r}=n;return c("select",{...r,onChange:s=>e(s.target.options.selectedIndex),children:n.options.map(s=>c("option",{value:s.value,title:s.title,children:s.label},s.value))})},Zt=n=>{const{value:t,defaultValue:e,onChange:r,...s}=n,[o,i]=u.useState(t??e);u.useEffect(()=>{i(t??e)},[t,e]);const a=u.useCallback(l=>{i(l),r==null||r(l)},[r]);return c("input",{...s,type:"checkbox",checked:o,onChange:l=>a(l.target.checked)})},St=n=>{const t=L("Switch");return t?c(t,{...n}):c(Zt,{...n})};function se({target:n,...t}){const e=Re(),r=W(`framework.react.rndrs.${n.replace(".",":")}`),s=u.useMemo(()=>{if(!r)return new Error(`Controller ${n} not found`);if(typeof r!="function")return new Error(`Controller ${n} is not a function`)},[r,n]);return u.useEffect(()=>{s===void 0&&e.error!==void 0&&e.reset()},[s,e]),s?e.throwError(s):c(r,{...t})}const kt=()=>{const n=u.useRef();return u.useCallback(t=>{typeof n.current=="number"&&clearTimeout(n.current),n.current=t},[])};function Ot(n){return u.useMemo(()=>q(n),[n._def])}function Nt(n){return u.useMemo(()=>ve(n._mode),[n._mode])}function ue(n,t,e,r){const s=`${n}.${t}`,o=W(`units.${s}`),i=W(`framework.react.units.${s}`),[,a]=u.useMemo(()=>(o==null?void 0:o.find(([v])=>v(e,r)))??[],[o,e,r]),[,l]=u.useMemo(()=>(i==null?void 0:i.find(([v])=>v(e,r)))??[],[i,e,r]);return u.useMemo(()=>{if(a){let v;const g=(p,m)=>typeof p=="function"?p(m):{...p,...m};switch(typeof a){case"string":v=p=>c(se,{target:a,...p});break;case"object":if(Array.isArray(a)){const[p,m]=a;v=R=>c(se,{target:p,...g(m,R)})}break;case"function":{const[p,m]=a({modes:e,modelType:t,...r});v=R=>c(se,{target:p,...g(m,R)});break}}return v}},[e,r,a,t])??l}function le(n,t,e){const r=u.useCallback(a=>{o(a),e==null||e(a)},[e]),[s,o]=u.useState(n??t),i=u.useRef(!1);return u.useEffect(()=>{i.current?o(n):(i.current=!0,r(n??t))},[r,t,n]),[s,r]}function $t(n){return n.map((t,e)=>({label:t._def.label??t._def.description??JSON.stringify(t._def.value)??`${e}nd`,title:t._def.description,value:e}))}function Dt({uKey:n,modes:t,model:e,value:r,defaultValue:s,...o}){const[i,a]=le(r,s,o.onChange),[l,f]=u.useState(void 0),v=u.useCallback(I=>{f(I);const Z=e.options[I];b(Z,d.ZodLiteral)&&(a==null||a(Z._def.value))},[e.options,a]),g=u.useMemo(()=>b(e,d.ZodDiscriminatedUnion)?[e.discriminator]:[],[e]),p=u.useMemo(()=>g.map(I=>i==null?void 0:i[I]),[g,i]),m=u.useMemo(()=>{const I=new Map;return e.options.forEach(Z=>{b(Z,d.ZodObject)&&g.forEach(h=>{Z.shape[h]&&(I.has(h)||I.set(h,[]),I.get(h).push(Z.shape[h]))})}),I},[g,e.options]),R=u.useMemo(()=>$t(e.options),[e.options]),S=u.useMemo(()=>{if(b(e,d.ZodDiscriminatedUnion)){const Z=e.discriminator,h=m.get(Z),y=g.findIndex(w=>w===Z);if(!h)return;const C=h.reduce((w,M)=>w.or(M));let _=0;for(let w=0;w<h.length;w++)if(h[w]._def.value===p[y]){_=w;break}const T=e.options[_];return b(T,d.ZodObject)?T.setKey(Z,C.label(C.options[_]._def.label)):void 0}const I=e.options[l];if(l!==void 0){if(l<0||l>=e.options.length){f(void 0);return}return I}},[g,m,p,l,e]);u.useEffect(()=>{const I=i;let Z=-1;b(e,d.ZodUnion)&&(Z=e.options.findIndex(h=>b(h,d.ZodLiteral)&&h._def.value===I)),b(e,d.ZodDiscriminatedUnion),Z!==-1&&f(Z)},[i,e.options,e]);const N=Tt(),D=S&&k(O,{children:[c(N.Append,{deps:[t,e.options,S,a],children:t.includes("append")&&S._def.typeName!==d.ZodLiteral&&c(J,{model:S,onChange:a})}),!t.includes("append")&&S._def.typeName!==d.ZodLiteral&&c(O,{children:c(A,{model:S,onChange:a})})]}),$=ue("complex",e._def.typeName,t,{model:e});return $?c($,{modes:t,model:e,options:R,OptionRender:D,...o,value:i,defaultValue:s,onChange:a}):k(O,{children:[b(e,d.ZodUnion)&&k(O,{children:[c(Rt,{options:R,value:l,onChange:v}),D]}),b(e,d.ZodDiscriminatedUnion)&&c(O,{children:D})]})}function jt({uKey:n,modes:t,model:e,...r}){const[s,o]=le(r.value,r.defaultValue,r.onChange),i={...r,value:s,onChange:o};let a=null;switch(e._def.typeName){case"ZodNumber":a=c(Y,{type:"number",...i});break;case"ZodString":a=c(Y,{...i});break;case"ZodDate":a=c(Y,{...i});break;case"ZodBoolean":a=c(St,{...i});break}const l=ue("monad",e._def.typeName,t);return l?c(l,{modes:t,model:e,...i}):a}const H="multiple";function Et({uKey:n,modes:t,model:e,onChange:r,...s}){const o=e._def,i=u.useMemo(()=>{if(b(e,d.ZodObject)){const h=e.shape;return Object.entries(h).reduce((y,[C,_])=>{let T=_;return _._def.label===void 0&&(T=_.label(C)),_._def.description===void 0&&(T=_.describe(C)),y[C]=T,y},{})}return b(e,d.ZodRecord)?Object.entries(s.value??s.defaultValue??{}).reduce((h,[y])=>(h[y]=e.valueSchema,h),{}):{}},[e,s.defaultValue,s.value]),a=u.useCallback(h=>b(e,d.ZodArray)?e._def.type:b(e,d.ZodTuple)?e._def.items[h]:b(e,d.ZodSet)||b(e,d.ZodRecord)||b(e,d.ZodMap)?e._def.valueType:b(e,d.ZodObject)?Object.values(i)[h]:null,[i,o.items,o.valueType,o.typeName]),l=u.useMemo(()=>ee(e,[d.ZodArray,d.ZodSet])?1/0:b(e,d.ZodTuple)?e._def.items.length:b(e,d.ZodObject)?Object.entries(e._def.shape()??{}).length:b(e,d.ZodRecord)?Object.entries(s.value??s.defaultValue??{}).length:0,[o]),f=u.useMemo(()=>b(e,d.ZodTuple)?e._def.items:b(e,d.ZodObject)?Object.values(i):b(e,d.ZodSet)||b(e,d.ZodRecord)||b(e,d.ZodMap)?Array.from({length:l}).map((h,y)=>a(y)):[],[i,o.typeName,o.items,o.valueType]),[v,g]=u.useState(!1),p=u.useCallback(()=>{const h=s.value??s.defaultValue;return Object.keys(i).length>0?Object.entries(i).map(([y,C])=>(h instanceof Map?h.get(y):!Array.isArray(h)&&!(h instanceof Set)?h==null?void 0:h[y]:void 0)??q(C)):b(e,d.ZodTuple)?e._def.items.map(q):h instanceof Set?Array.from(h):Array.isArray(h)?h:[]},[i,e,s.defaultValue,s.value]),m=u.useRef(p());u.useEffect(()=>{m.current=p().map((h,y)=>h??m.current[y]),g(h=>!h)},[f,p]);const R=u.useMemo(()=>Object.keys(i??{}),[i]),S=u.useRef([]),N=u.useCallback(h=>{const y=S.current;h!==void 0&&(m.current=h);let C;ee(e,[d.ZodArray,d.ZodTuple,d.ZodSet])?C=m.current:C=m.current.reduce((_,T,w)=>({..._,[y[w]??R[w]??w]:T}),{}),b(e,d.ZodMap)&&(C=new Map(Object.entries(C))),r==null||r(C)},[e,r,R]),D=u.useCallback((h="append")=>{const y=m.current,C=[q(a())];y===void 0?m.current=C:m.current=h==="append"?y.concat(C):C.concat(y),g(_=>!_),N()},[N,a]),$=u.useMemo(()=>it.includes(e._def.typeName),[e._def.typeName]),I=Re(),Z=ue("multiple",e._def.typeName,t,{schemas:f});return f.length===0&&e._def.typeName===d.ZodTuple?I.throwError(new Error("Tuple 类型必须包含一个元素")):Z?c(Z,{...s,modes:t,model:e,schemas:f,value:m.current,onChange:N}):k(O,{children:[m.current.length===0&&c(E,{className:`${H}-create`,icon:"Add",onClick:()=>D()}),m.current.map((h,y)=>{const C=a(y);if(!C)return c(u.Fragment,{},y);const _=ct.includes(e._def.typeName);return k("div",{className:`${H}-item`,children:[((R[y]??(C==null?void 0:C._def.label))||_)&&c("div",{className:`${H}-item__label`+(_?" editable":""),children:_?c(Y,{className:"key-input",placeholder:"请输入键名",value:S.current[y],onChange:T=>{const M=S.current.slice();M[y]=T.toString(),S.current=M,g(Q=>!Q),N()}}):C._def.label??R[y]}),c("div",{className:`${H}-item__index-tag`,children:y+1}),!$&&k(O,{children:[y===0?c(E,{shape:"square",variant:"outline",icon:"Prepend",onClick:()=>D("prepend")}):c(E,{shape:"square",variant:"outline",icon:"ArrowUp",onClick:()=>{const T=m.current[y];m.current[y]=m.current[y-1],m.current[y-1]=T,g(w=>!w),N()}}),y===m.current.length-1?c(E,{shape:"square",variant:"outline",icon:"Append",onClick:()=>D("append")}):c(E,{shape:"square",variant:"outline",icon:"ArrowDown",onClick:()=>{const T=m.current[y];m.current[y]=m.current[y+1],m.current[y+1]=T,g(w=>!w),N()}})]}),c(A,{disabled:s.disabled??!1,className:`${H}-item__container`,model:C,value:h,defaultValue:q(C),onChange:T=>{m.current[y]=T,N()}}),c(E,{theme:"error",disabled:$?s.disabled??h===void 0:s.disabled,icon:$?"Clear":"Delete",onClick:()=>{$?m.current[y]=void 0:m.current=m.current.filter((T,w)=>w!==y),g(T=>!T),N()}}),c(E,{icon:"More"})]},y)})]})}const Mt=[["monad",ut,jt],["complex",dt,Dt],["multiple",ge,Et]];function xt(n,t){return ee(t[0],n)}function A(n){const{model:t,...e}=n,{className:r,ControllerClassName:s}=gt(),o=Ot(t),i=n.defaultValue??o,a=Nt(t),[l,f=null]=u.useMemo(()=>{for(const[g,p,m]of Mt){const R=[t,m];if(xt(p,R)){const[S,N]=R;return[g,c(N,{model:S,modes:a,...e})]}}return[]},[t,a,e]);if(b(t,d.ZodDefault)){const{innerType:g,defaultValue:p,typeName:m,...R}=t._def;return Object.assign(g._def,R),c(A,{...n,model:g,defaultValue:i})}if(b(t,d.ZodOptional)){const{innerType:g,typeName:p,...m}=t._def;return Object.assign(g._def,m),c(A,{...n,model:g})}if(b(t,d.ZodIntersection))return k(O,{children:[c(A,{...n,model:t._def.left}),c(A,{...n,model:t._def.right})]});const v=[At(d.ZodLiteral,({model:g})=>c(O,{children:JSON.stringify(g.value)}))];return c("div",{className:V("zodui-switcher",!!f&&l,t.type,r),children:c(s,{children:f||(v.reduce((g,[p,m])=>b(t,p)?c(m,{model:t}):g,null)??k("span",{style:{width:"100%"},children:["暂未支持的的类型 ",c("code",{children:t.type})]}))})})}function At(n,t){return[n,t]}const z="zodui-item";function Pt(n,t){const e=Se(),{meta:{label:r,description:s},value:o,defaultValue:i,onChange:a,model:l,className:f}=n,v=u.useMemo(()=>ot.some(_=>{const T=ve(l._mode);return typeof _=="string"?T.some(w=>w==null?void 0:w.startsWith(_)):T.some(w=>_.test(w))}),[l._mode]),{Append:g,ItemSerter:p}=wt(),{error:m,ErrorHandler:R}=_t(),[S,N]=u.useState(!1),[D,$]=u.useState(!1),I=u.useRef(o??i);I.current!==o&&!D&&(I.current=o);const Z=u.useRef(),h=u.useCallback(_=>(Z.current=_,()=>{Z.current=void 0}),[]),y=kt(),C=u.useCallback((_,T=!1,w=e.actualTimeVerify)=>{y(setTimeout(async()=>{var Q;const M=I.current;try{const x=w?await((Q=Z.current)==null?void 0:Q.call(Z,_))??_:_;I.current=x,await(a==null?void 0:a(x)),$(T)}catch(x){if(I.current=M,x instanceof ye)T&&(I.current=_,$(!0));else throw x}T&&N(x=>!x)},e.verifyDebounceTime))},[y,e.verifyDebounceTime,e.actualTimeVerify,a]);return u.useImperativeHandle(t,()=>({verify:async()=>C(I.current,!1,!0)}),[C]),k(p,{children:[c(R,{children:k("div",{className:V(`${z} ${l.type}`,{error:!!m,wrap:v,[l._mode]:!!l._mode},!!f&&f),children:[c("div",{className:`${z}__more`,children:c(It,{menu:[{icon:"Clear",label:"重置",title:"将数据设置为默认值，若无默认值则与清空行为一致",value:"reset"},{icon:"Delete",label:"置空",title:"将数据设置为空值，即数据未被设置模式",value:"clear"}],onAction:async _=>{switch(_){case"reset":C(i,!0);break;case"clear":C(void 0,!0,!1);break}},children:c(E,{shape:"square",variant:"text",icon:"More",disabled:!!m})})}),k("div",{className:V(`${z}__label`,{"is-optional":l._def.typeName===d.ZodOptional}),children:[r,s&&c("pre",{className:`${z}__label-description inline-md`,dangerouslySetInnerHTML:{__html:Ce(s)}})]}),c(A,{uKey:n.uKey,model:l,disabled:n.disabled,value:I.current,defaultValue:i,onChange:C})]})}),c(g,{}),c(Vt,{value:I.current,schema:l,onValueChange:h}),m&&c("div",{className:`${z}__error`,children:m.message})]})}const te=u.forwardRef(Pt);te.displayName="Item";function Vt({value:n,schema:t,onValueChange:e}){const{actualTimeVerify:r}=Se(),[s,o]=u.useState(),i=u.useCallback(async function(a){try{const l=t.parse(a);return o(void 0),l}catch(l){throw console.warn(l),l instanceof ye&&o(l),l}},[t]);return u.useEffect(()=>(r&&i(n).catch(()=>null),e(i)),[r,n,t,i,e]),c("div",{className:V(`${z}__error`,{none:!s}),children:s&&s.errors.map((a,l)=>k("div",{children:[a.path.map(f=>typeof f=="number"?`${f}nd`:f).join(".")," ",a.message]},l))})}const X="zodui-composer-list";function Lt(n,t){const{model:e,value:r,defaultValue:s,onChange:o,disabled:i}=n,a=e._def,l=u.useRef((()=>{const p=e._type===d.ZodObject?{}:e._type===d.ZodArray?[]:void 0;return r??s??p})()),f=u.useCallback(p=>{l.current=p,o==null||o(p)},[o]),v=u.useRef({});if(u.useImperativeHandle(t,()=>({async verify(){const p=Object.entries(v.current).map(([m,R])=>R?R.verify():Promise.resolve());return await Promise.all(p),l.current},reset(){f(s??{})},watch(){throw new Error("Not implemented")},get values(){return l.current}}),[f,s]),b(a,d.ZodIntersection))return k(O,{children:[c(J,{prefix:"intersect::left",className:n.className,style:n.style,disabled:i,model:a.left,value:l.current,onChange:async p=>f(ie(l.current,p))}),c(J,{prefix:"intersect::right",className:n.className,style:n.style,disabled:i,model:a.right,value:l.current,onChange:async p=>f(ie(l.current,p))})]});const g=ee(e,ge);return k("div",{className:V(X,n.className),style:n.style,children:[g&&k("div",{className:`${X}__header`,children:[a.label&&c("h2",{className:V(`${X}__label`,{"is-optional":a.typeName===d.ZodOptional}),children:a.label}),a.description&&c("pre",{className:`${X}__desc inline-md`,dangerouslySetInnerHTML:{__html:Ce(a.description)}})]}),b(a,d.ZodObject)?Object.entries(a.shape()).map(([p,m])=>{var R;return c(te,{ref:S=>v.current[p]=S,uKey:`${n.prefix||""}.${p}`,meta:{label:m._def.label||p,description:m._def.description},model:m,disabled:i,value:(R=l.current)==null?void 0:R[p],onChange:S=>f({...l.current,[p]:S})},p)}):c(te,{ref:p=>v.current.single=p,uKey:"single",meta:{label:e._label||(a==null?void 0:a.description)||e.type,description:a.description},model:e,disabled:i,value:l.current,onChange:f})]})}const J=u.forwardRef(Lt);J.displayName="List-Composer";J.Item=te;function Ut(n,t){return t.includes(n)}function K(n){return n?`${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}`:void 0}const Ft=ne("TDesign.React.Components",n=>{n.framework("react").defineComp("Button",({theme:e,...r})=>c(je,{theme:{info:"default",error:"danger",warning:"warning",success:"success"}[e],...r})).defineComp("Input",({type:e,mode:r,value:s,defaultValue:o,onChange:i,...a})=>{if(Ut(e,["email","tel","url","search"]))return k(O,{children:["Not support type ",e]});if(e==="number"&&r==="split"){const l=f=>f!==void 0?+f:void 0;return c(Ee,{value:l(s),defaultValue:l(o),onChange:i})}return c(Me,{type:e,value:s,defaultValue:o,onChange:l=>i==null?void 0:i(e==="number"?+l:l),...a})}).defineComp("InputAdornment",({prev:e,next:r,...s})=>c(xe,{prepend:e,append:r,...s})).defineComp("Select",e=>c(Ae,{...e,value:e.value,onChange:r=>{var s;return(s=e.onChange)==null?void 0:s.call(e,r)}})).defineComp("Switch",e=>c(Pe,{...e})).defineComp("RadioGroup",e=>c(fe.Group,{allowUncheck:!0,className:V(e.className,{[`zodui-tdesign-radio-group--direction-${e.direction??"row"}`]:!!e.direction}),variant:{outline:"outline",card:"default-filled",undefined:void 0}[e.variant],options:e.variant!=="outline"?e.options:[],value:e.value,defaultValue:e.defaultValue,onChange:r=>{var s;return(s=e.onChange)==null?void 0:s.call(e,r)},children:e.variant==="outline"?e.options.map(r=>c(fe.Button,{value:r.value,title:r.title,disabled:r.disabled,children:r.label},r.value)):null})).defineComp("Dropdown",e=>c(Ve,{popupProps:{showArrow:!0,overlayClassName:"zodui-tdesign-popup",popperOptions:{modifiers:[{name:"offset",options:{offset:[4,0]}}]}},options:e.menu.map(r=>({prefixIcon:typeof r.icon=="string"?c(Oe,{name:r.icon}):r.icon,content:typeof r.label=="string"?c("span",{title:r.title,children:r.label}):u.cloneElement(r.label,{title:r.title}),value:r.value,disabled:r.disabled})),trigger:e.trigger??"click",minColumnWidth:120,onClick:r=>{e.onAction(r.value,r)},children:e.children}))}),Kt=Object.freeze(Object.defineProperty({__proto__:null,ComponentsOfTDesignComponentsLibForReact:Ft},Symbol.toStringTag,{value:"Module"})),zt=ne("TDesign.React.Renders",n=>{n.framework("react").defineIcon("Add",We).defineIcon("More",Je).defineIcon("Link",Qe).defineIcon("Clear",Xe).defineIcon("Delete",Ye).defineIcon("Prepend",e=>c(me,{style:{transform:"rotate(90deg)"},...e})).defineIcon("Append",e=>c(me,{style:{transform:"rotate(-90deg)"},...e})).defineIcon("ArrowUp",et).defineIcon("ArrowDown",tt)}),Bt=Object.freeze(Object.defineProperty({__proto__:null,IconsOfTDesignComponentsLibForReact:zt},Symbol.toStringTag,{value:"Module"})),Ht=ne("TDesign.React.Renders",n=>{n.framework("react").defineRndr("Number:Slider",e=>{const[r,s]=le(e.value,e.defaultValue,e.onChange);return c(Le,{...e,value:r,onChange:s,...e.range?{defaultValue:e.defaultValue??[0,0],onChange:([o,i])=>s==null?void 0:s([o??0,i??0])}:{}})}).defineRndr("String:TextArea",e=>c(Ue,{autosize:{minRows:1},...e})).defineRndr("Date:Picker",({isPanel:e,datetime:[r,s]=[!0,!0],...o})=>{const i=o.onChange,a=u.useCallback(f=>f===void 0?i==null?void 0:i(void 0):i==null?void 0:i(new Date(f)),[i]);if(!r){const f=K(o.value),v=K(o.defaultValue);return e?c(Fe,{...o,value:v||f,onChange:g=>a(`1970-01-01 ${g}`)}):c(Ke,{...o,value:f,defaultValue:v,onChange:g=>a(`1970-01-01 ${g}`)})}const l={...o,enableTimePicker:r&&s};return e?c(ze,{...l,onChange:f=>a(f)}):c(Be,{...l,valueType:"Date",onChange:f=>a(f)})}).defineRndr("Range:Date:Picker",({isPanel:e,datetime:[r,s]=[!0,!0],...o})=>{if(o.value===void 0&&(o.value=[]),!r&&s)return e?k(O,{children:["TDesign unable support ",c("code",{children:"TimePickerRangePanel"}),"."]}):c(He,{...o,value:[K(o.value[0]),K(o.value[1])],defaultValue:[K(o.defaultValue[0]),K(o.defaultValue[1])],onChange:a=>{var l;return(l=o.onChange)==null?void 0:l.call(o,[new Date(`1970-01-01 ${a[0]}`),new Date(`1970-01-01 ${a[1]}`)])}});const i={...o,enableTimePicker:r&&s};return e?c(qe,{...i,onChange:a=>{var l;return(l=o.onChange)==null?void 0:l.call(o,[new Date(a[0]),new Date(a[1])])}}):c(Ge,{...i,valueType:"Date",onChange:a=>{var l;return(l=o.onChange)==null?void 0:l.call(o,[new Date(a[0]),new Date(a[1])])}})})}),qt=Object.freeze(Object.defineProperty({__proto__:null,RendersOfTDesignComponentsLibForReact:Ht},Symbol.toStringTag,{value:"Module"})),sn=ne("TDesign.React",n=>{n.use(()=>re(()=>Promise.resolve().then(()=>Kt),void 0).then(({ComponentsOfTDesignComponentsLibForReact:t})=>t)),n.use(()=>re(()=>Promise.resolve().then(()=>Bt),void 0).then(({IconsOfTDesignComponentsLibForReact:t})=>t)),n.use(()=>re(()=>Promise.resolve().then(()=>qt),void 0).then(({RendersOfTDesignComponentsLibForReact:t})=>t))});export{d as A,oe as C,O as F,Y as I,J as L,rn as R,St as S,sn as T,re as _,nn as a,Oe as b,se as c,ne as d,tn as e,k as f,c as j,we as n,en as u};
